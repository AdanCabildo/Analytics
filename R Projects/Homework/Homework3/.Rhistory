labs(title = "Top 25 Categories by Age Group",
x = "Itemized Purchase",
y = "Frequency") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
coord_cartesian(ylim = c(0, 100))  # Set y-axis limits
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Itemized Purchases", xlab = "Frequency", ylab = "Category Description")
)
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
# load hw2data.rda from the working directory
load('hw2data.rda')
# loading necessary libraries
library(ggplot2)
library(dplyr)
# merging item.purchases with item.key to get category descriptions
merged_data = item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc"))
# Count the frequency of each category
category_counts = merged_data %>%
group_by(descr) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
head(25)
# load hw2data.rda from the working directory
load('hw2data.rda')
# loading necessary libraries
library(ggplot2)
library(dplyr)
# merging item.purchases with item.key to get category descriptions
merged_data = item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc"))
# Count the frequency of each category
category_counts = merged_data %>%
group_by(descr) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
head(25)
# loading necessary libraries
library(ggplot2)
library(dplyr)
# merging item.purchases with item.key to get category descriptions
merged_data = item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc"))
# Count the frequency of each category
category_counts = merged_data %>%
group_by(descr) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
head(25)
# loading necessary libraries
library(ggplot2)
library(dplyr)
# merging item.purchases with item.key to get category descriptions
merged_data = item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc"))
# Count the frequency of each category
category_counts = merged_data %>%
group_by(ucc, descr) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
head(25)
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Itemized Purchases", xlab = "Frequency", ylab = "Category Description")
)
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref_person, breaks = 10))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref_person, breaks = 10))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Itemized Purchases", xlab = "Frequency", ylab = "Category Description")
)
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n(age_group)) %>%
arrange(age_group, desc(count))
# Group the data into 10 equally sized age groups according to the age of the reference person
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
# Count the frequency of each category within each age group
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
category_freq <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
item_purchases_age <- item.purchases %>%
left_join(item.key, by = c("ucc" = "ucc")) %>%
left_join(household, by = c("newid" = "newid")) %>%
mutate(age_group = cut(age_ref, breaks = 10))
category_counts <- item_purchases_age %>%
group_by(age_group, descr) %>%
summarize(count = n()) %>%
arrange(age_group, desc(count))
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Itemized Purchases", xlab = "Frequency", ylab = "Category Description")
)
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
# Merge the item.purchases data frame with the item.key data frame based on the ucc column
merged_item_data = merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
# Calculate the frequency of each category description
category_freq = table(merged_item_data$descr)
# Sort the frequencies in ascending order and select the top 25 category descriptions
top_categories = names(tail(sort(category_freq, decreasing = FALSE), 25))
# Create the dot chart using the top 25 category descriptions and their frequencies in ascending order
dotchart(category_freq[top_categories], main = "Top 25 Most Common Itemized Purchases", xlab = "Frequency", ylab = "Category Description")
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(Hmisc)
library(knitr)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
install.packages("tidyverse")
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
#merge data with age reference from household
merged_item_household_data = merge(select(merged_item_data, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
#group the data according to age reference into 10 equal parts
merged_item_household_data = merged_item_household_data %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
#calculate the frequency of descr in each age group
frequency_counts = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
#get the top 25 descr in each age group
top_descr = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
#get the average freq in each age group
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "lightgreen", inherit.aes = FALSE) +
labs(title= "Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)  # Use facet_wrap() to create 10 charts, one per age group
print(plot)
#merge data with age reference from household
merged_item_household_data = merge(select(merged_item_data, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
#group the data according to age reference into 10 equal parts
merged_item_household_data = merged_item_household_data %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
#calculate the frequency of descr in each age group
frequency_counts = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
#get the top 25 descr in each age group
top_descr = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
#get the average freq in each age group
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)  # Use facet_wrap() to create 10 charts, one per age group
print(plot)
#merge data with age reference from household
merged_item_household_data = merge(select(merged_item_data, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
#group the data according to age reference into 10 equal parts
merged_item_household_data = merged_item_household_data %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
#calculate the frequency of descr in each age group
frequency_counts = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
#get the top 25 descr in each age group
top_descr = merged_item_household_data %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
#get the average freq in each age group
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)  # Use facet_wrap() to create 10 charts, one per age group
print(plot)
merged_item_household = merge(select(merged_item_data, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
#group the data according to age reference into 10 equal parts
merged_item_household = merged_item_household %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
#calculate the frequency of descr in each age group
frequency_counts = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
#get the top 25 descr in each age group
top_descr = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
#get the average freq in each age group
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Figure 2: Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)
print(plot)
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
merged_item_household = merge(select(merged_item_data, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
merged_item_household = merge(select(merged_item, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
#group the data according to age reference into 10 equal parts
merged_item_household = merged_item_household %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
#calculate the frequency of descr in each age group
frequency_counts = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
#get the top 25 descr in each age group
top_descr = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
#get the average freq in each age group
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Figure 2: Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)
print(plot)
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
merged_item_household = merge(select(merged_item, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
merged_item_household = merged_item_household %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
frequency_counts = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
top_descr = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Figure 2: Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)
print(plot)
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
merged_item_household = merge(select(merged_item, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
merged_item_household = merged_item_household %>% mutate(age_group = cut(age_ref, breaks = 10, labels = TRUE))
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
load('hw2data.rda')
merged_item <- merge(item.purchases, item.key, by = "ucc", all.x = TRUE)
category_freq <- table(merged_item$descr)
top_categories <- names(tail(sort(category_freq, decreasing = FALSE), 25))
suppressWarnings(
dotchart(category_freq[top_categories], main = "Figure 1: Top 25 Most Common Purchases", xlab = "Frequency", ylab = "Category Description")
)
merged_item_household = merge(select(merged_item, newid, descr, ucc), select(household, newid, age_ref), by = "newid") %>%
arrange(age_ref)
merged_item_household = merged_item_household %>% mutate(age_group = cut(age_ref, breaks = 10, labels = FALSE))
frequency_counts = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarize(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq))
top_descr = merged_item_household %>%
group_by(age_group, descr) %>%
dplyr::summarise(freq = n(), .groups = "drop") %>%
arrange(age_group, desc(freq)) %>%
group_by(age_group) %>%
top_n(25, freq)
average = top_descr %>%
group_by(descr) %>%
dplyr::summarise(average = mean(freq, na.rm = TRUE))
#plot the charts
plot = ggplot(top_descr, aes(x =descr, y = freq)) +
geom_point() +
geom_line(data = average, aes(x = descr, y = average, group = 1), color = "red", inherit.aes = FALSE) +
labs(title= "Figure 2: Top 25 Items per Age Group", x = "Frequency", y ="Category Description") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~age_group, ncol = 2)
print(plot)
